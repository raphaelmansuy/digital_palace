# Part 4: Protocols & Architecture

[â† Previous: Platforms Compared](./03-platforms-compared.md) | [Back to Index](./README.md) | [Next: Implementation Guide â†’](./05-implementation.md)

---

## The Plumbing That Makes It Work

We've seen **what** platforms provide and **which** platforms exist. Now let's understand **how** they work under the hood.

Two protocols are emerging as standards:

1. **MCP (Model Context Protocol)** - Tool integration standard (like USB-C for AI)
2. **A2A (Agent-to-Agent Protocol)** - Agent communication standard (like SMTP for agents)

Plus the **unified core architecture** that all platforms share.

---

## MCP: The "USB-C for AI Tools"

### The Problem MCP Solves

**Before MCP** (2023-2024):

```text
Every agent builds custom integrations to every tool:

Agent A â”€â”€â”¬â”€â”€â”€ Custom Salesforce connector (1000 lines)
          â”œâ”€â”€â”€ Custom Slack connector (800 lines)
          â””â”€â”€â”€ Custom GitHub connector (1200 lines)

Agent B â”€â”€â”¬â”€â”€â”€ Different Salesforce connector! (1000 lines)
          â”œâ”€â”€â”€ Different Slack connector! (800 lines)
          â””â”€â”€â”€ Different GitHub connector! (1200 lines)

Total: 6000 lines of duplicated integration code
```

**With MCP** (2025 onwards):

```text
Standard protocol, reusable connectors:

MCP Server: Salesforce â”€â”€â”¬â”€â”€â”€ Agent A
MCP Server: Slack â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€ Agent B
MCP Server: GitHub â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€ Agent C

Total: 3 MCP servers, shared by all agents
```

### MCP Architecture

```text
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    MCP ARCHITECTURE                              â•‘
â•‘                "USB-C for AI Tools"                              â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                  â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                    YOUR AI AGENTS                        â”‚  â•‘
â•‘   â”‚  [Customer Service] [Sales] [Data] [Code] [HR]           â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘             â”‚           â”‚            â”‚          â”‚                â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚          MCP CLIENT (in your platform)                   â”‚  â•‘
â•‘   â”‚  - Discovery: What tools are available?                  â”‚  â•‘
â•‘   â”‚  - Request formatting: Convert agent intent to MCP       â”‚  â•‘
â•‘   â”‚  - Response parsing: Convert MCP back to agent context   â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘             â”‚           â”‚            â”‚          â”‚                â•‘
â•‘             â”‚  MCP Protocol (JSON-RPC over stdio/HTTP/SSE)   â”‚  â•‘
â•‘             â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         â”‚  â•‘
â•‘             â”‚  â”‚ Standard Message Format:          â”‚         â”‚  â•‘
â•‘             â”‚  â”‚ { "method": "tools/call",         â”‚         â”‚  â•‘
â•‘             â”‚  â”‚   "params": {                     â”‚         â”‚  â•‘
â•‘             â”‚  â”‚     "name": "query_crm",          â”‚         â”‚  â•‘
â•‘             â”‚  â”‚     "arguments": {...}            â”‚         â”‚  â•‘
â•‘             â”‚  â”‚   }                                â”‚         â”‚  â•‘
â•‘             â”‚  â”‚ }                                  â”‚         â”‚  â•‘
â•‘             â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚  â•‘
â•‘             â”‚           â”‚            â”‚          â”‚                â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚                    MCP SERVERS                           â”‚  â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘   â”‚  â”‚Salesforceâ”‚  â”‚  Slack   â”‚  â”‚  GitHub  â”‚  â”‚ Custom  â”‚  â”‚  â•‘
â•‘   â”‚  â”‚  Server  â”‚  â”‚  Server  â”‚  â”‚  Server  â”‚  â”‚  Tool   â”‚  â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘           â”‚             â”‚             â”‚             â”‚           â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚              EXTERNAL SERVICES                           â”‚  â•‘
â•‘   â”‚  [Salesforce API] [Slack API] [GitHub API] [Your API]   â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

KEY BENEFITS:
â”œâ”€ Reusability: One MCP server, many agents
â”œâ”€ Discoverability: Agents ask "what tools exist?"
â”œâ”€ Standardization: Same protocol for all tools
â””â”€ Security: MCP server handles auth, not agents
```

### MCP Message Flow: Example

**Scenario**: Agent wants to query Salesforce CRM.

```text
STEP 1: Agent discovers available tools
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ MCP Client  â”‚
â”‚          â”‚  "What tools can I use?"  â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â”‚ tools/list
                                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ MCP Server:      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ MCP Client  â”‚
â”‚ Salesforce       â”‚   discovery req   â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ returns: ["query_crm", "create_lead", "update_opp"]
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MCP Server:      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ MCP Client  â”‚
â”‚ Salesforce       â”‚   tool list        â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â”‚ presents tools
                                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚  Agent   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ MCP Client  â”‚
â”‚          â”‚  "You can use query_crm"  â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 2: Agent calls tool
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent   â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ MCP Client  â”‚
â”‚          â”‚ query_crm(customer="XYZ") â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â”‚ tools/call
                                              â”‚ { "name": "query_crm",
                                              â”‚   "arguments": {"customer": "XYZ"} }
                                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚ MCP Server:      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ MCP Client  â”‚
â”‚ Salesforce       â”‚   tool call       â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
         â”‚
         â”‚ executes: Salesforce API call
         â”‚ (handles OAuth, rate limits, retries)
         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ MCP Server:      â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚ MCP Client  â”‚
â”‚ Salesforce       â”‚   result           â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   {customer data}  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                                              â”‚
                                              â”‚ parses result
                                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                           â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
â”‚  Agent   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ MCP Client  â”‚
â”‚          â”‚  customer data             â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

STEP 3: Agent continues reasoning
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Agent   â”‚ "Based on customer XYZ's data, I should..."
â”‚          â”‚ (continues agent logic with tool result)
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### MCP Ecosystem (October 2025)

**Official MCP Servers** (from Anthropic and community):

- **Claude Desktop**: filesystem, database, web browsing
- **AWS**: S3, DynamoDB, Lambda, Bedrock
- **Google**: BigQuery, Cloud Storage, Vertex AI
- **Databases**: PostgreSQL, MySQL, MongoDB, Redis
- **DevOps**: GitHub, GitLab, Kubernetes, Docker
- **Productivity**: Slack, Notion, Google Workspace

**MCP Server Statistics**:
- 100+ community MCP servers (as of Oct 2025)
- Growing at ~10 new servers per week
- Standard: All use JSON-RPC over stdio/HTTP/SSE

**Key Platforms Supporting MCP**:
- âœ… AWS Bedrock (Gateway service)
- âœ… Google ADK (MCP client built-in)
- âœ… Salesforce Agentforce (MCP integration)
- âœ… Claude Desktop (native MCP support)
- âœ… LangChain, LangGraph, CrewAI (via connectors)

**Why MCP is winning**: It's **open, simple, and battle-tested** (inspired by LSP - Language Server Protocol).

---

## A2A: Agent-to-Agent Communication

### The Problem A2A Solves

**Before A2A**:

```text
Agent A needs help from Agent B:

Problem 1: Discovery
â””â”€ How does Agent A even know Agent B exists?
   â””â”€ Hardcoded list? Service registry? Manual config?

Problem 2: Communication
â””â”€ How do agents exchange messages?
   â””â”€ REST API? WebSocket? Custom protocol?

Problem 3: Context Transfer
â””â”€ How does Agent B understand what Agent A was doing?
   â””â”€ Shared database? Message payload? No context?

Problem 4: Trust
â””â”€ Should Agent B trust Agent A's request?
   â””â”€ Authentication? Authorization? Audit?

Result: Every company builds custom solutions.
```

**With A2A**:

```text
Standard protocol for agent coordination:

Agent A â”€â”€â”€â”€â”€â”¬â”€ A2A Protocol â”€â”€â”€> Agent B
             â”‚  - Discovery: Who can do what?
             â”‚  - Message format: Standard JSON-RPC
             â”‚  - Context: Shared conversation state
             â””â”€ Security: Identity + permissions
```

### A2A Protocol Architecture

```text
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                    A2A PROTOCOL ARCHITECTURE                     â•‘
â•‘              "Agent-to-Agent Communication Standard"             â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                  â•‘
â•‘   AGENT DISCOVERY (Dynamic Service Registry)                    â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚              A2A Service Registry                        â”‚  â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘   â”‚  â”‚ Agent: sales_assistant                            â”‚  â”‚  â•‘
â•‘   â”‚  â”‚ Capabilities: [customer_lookup, send_proposal]    â”‚  â”‚  â•‘
â•‘   â”‚  â”‚ Endpoint: https://api.company.com/agents/sales    â”‚  â”‚  â•‘
â•‘   â”‚  â”‚ Auth: OAuth2 client credentials                   â”‚  â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â•‘
â•‘   â”‚  â”‚ Agent: data_analyst                               â”‚  â”‚  â•‘
â•‘   â”‚  â”‚ Capabilities: [run_analytics, generate_report]    â”‚  â”‚  â•‘
â•‘   â”‚  â”‚ Endpoint: https://api.company.com/agents/data     â”‚  â”‚  â•‘
â•‘   â”‚  â”‚ Auth: OAuth2 client credentials                   â”‚  â”‚  â•‘
â•‘   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                              â–²                                   â•‘
â•‘                              â”‚ query: "Who can run_analytics?"  â•‘
â•‘                              â”‚                                   â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚              AGENT A (Sales Assistant)                   â”‚  â•‘
â•‘   â”‚  â”€ Needs analytics on customer XYZ                       â”‚  â•‘
â•‘   â”‚  â”€ Discovers Agent B via A2A registry                    â”‚  â•‘
â•‘   â”‚  â”€ Sends A2A task request                                â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                          â”‚                                       â•‘
â•‘                          â”‚ A2A MESSAGE (JSON-RPC)                â•‘
â•‘                          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘                          â”‚ â”‚ {                               â”‚  â•‘
â•‘                          â”‚ â”‚   "jsonrpc": "2.0",             â”‚  â•‘
â•‘                          â”‚ â”‚   "method": "agent/invoke",     â”‚  â•‘
â•‘                          â”‚ â”‚   "params": {                   â”‚  â•‘
â•‘                          â”‚ â”‚     "task": "run_analytics",    â”‚  â•‘
â•‘                          â”‚ â”‚     "context": {                â”‚  â•‘
â•‘                          â”‚ â”‚       "customer_id": "XYZ",     â”‚  â•‘
â•‘                          â”‚ â”‚       "conversation_id": "123", â”‚  â•‘
â•‘                          â”‚ â”‚       "history": [...]          â”‚  â•‘
â•‘                          â”‚ â”‚     }                            â”‚  â•‘
â•‘                          â”‚ â”‚   },                            â”‚  â•‘
â•‘                          â”‚ â”‚   "auth": {                     â”‚  â•‘
â•‘                          â”‚ â”‚     "token": "...",             â”‚  â•‘
â•‘                          â”‚ â”‚     "agent_id": "sales_agent"   â”‚  â•‘
â•‘                          â”‚ â”‚   }                             â”‚  â•‘
â•‘                          â”‚ â”‚ }                               â”‚  â•‘
â•‘                          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                          â”‚                                       â•‘
â•‘                          â–¼                                       â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚              AGENT B (Data Analyst)                      â”‚  â•‘
â•‘   â”‚  â”€ Receives task with full context                       â”‚  â•‘
â•‘   â”‚  â”€ Runs analytics on customer XYZ                        â”‚  â•‘
â•‘   â”‚  â”€ Returns results via A2A                               â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                          â”‚                                       â•‘
â•‘                          â”‚ A2A RESPONSE                          â•‘
â•‘                          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘                          â”‚ â”‚ {                               â”‚  â•‘
â•‘                          â”‚ â”‚   "jsonrpc": "2.0",             â”‚  â•‘
â•‘                          â”‚ â”‚   "result": {                   â”‚  â•‘
â•‘                          â”‚ â”‚     "analytics": {              â”‚  â•‘
â•‘                          â”‚ â”‚       "ltv": "$50K",            â”‚  â•‘
â•‘                          â”‚ â”‚       "churn_risk": "low"       â”‚  â•‘
â•‘                          â”‚ â”‚     }                            â”‚  â•‘
â•‘                          â”‚ â”‚   },                            â”‚  â•‘
â•‘                          â”‚ â”‚   "conversation_id": "123"      â”‚  â•‘
â•‘                          â”‚ â”‚ }                               â”‚  â•‘
â•‘                          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                          â–¼                                       â•‘
â•‘   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â•‘
â•‘   â”‚              AGENT A (Sales Assistant)                   â”‚  â•‘
â•‘   â”‚  â”€ Receives analytics with full context                  â”‚  â•‘
â•‘   â”‚  â”€ Continues conversation with customer                  â”‚  â•‘
â•‘   â”‚  â”€ "Based on your $50K lifetime value..."                â”‚  â•‘
â•‘   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â•‘
â•‘                                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

KEY BENEFITS:
â”œâ”€ Discovery: Agents find each other dynamically
â”œâ”€ Context Transfer: Full conversation history preserved
â”œâ”€ Security: Authentication + authorization built-in
â””â”€ Cross-Platform: Works across clouds (GCP, AWS, on-prem)
```

### A2A vs Traditional APIs

| Feature | Traditional REST API | A2A Protocol |
|---------|---------------------|--------------|
| **Discovery** | Hardcoded endpoints | Dynamic service registry |
| **Context** | Stateless (pass everything) | Stateful (conversation ID) |
| **Security** | API keys, OAuth | Agent identity + permissions |
| **Format** | Custom JSON | Standard JSON-RPC |
| **Coordination** | Manual orchestration | Built-in task handoff |
| **Observability** | Custom logging | A2A trace headers |

**Example**: Agent A needs help from Agent B.

**Traditional API approach**:

```python
# Agent A code:
import requests

# Hardcoded endpoint (brittle)
response = requests.post(
    'https://api.company.com/agents/data_analyst/run_analytics',
    json={'customer_id': 'XYZ'},
    headers={'Authorization': 'Bearer ' + api_key}
)

# No conversation context! Agent B starts from scratch.
# Agent A must manually pass all relevant history.
```

**A2A approach**:

```python
# Agent A code:
from google.adk.protocols.a2a import A2AClient

a2a = A2AClient()

# Dynamic discovery (flexible)
data_agent = a2a.discover(capability='run_analytics')

# Context automatically transferred
response = a2a.send_task(
    agent=data_agent,
    task='run_analytics',
    params={'customer_id': 'XYZ'}
    # conversation_id, history, auth handled automatically
)

# Agent B receives full context, continues seamlessly.
```

### A2A Adoption (October 2025)

**Google's A2A Partners** (50+ announced):

- **Enterprise Software**: Box, Deloitte, Elastic, MongoDB, Salesforce, ServiceNow, UiPath
- **Collaboration**: Cisco, Miro, Slack
- **Data & Analytics**: Databricks, Snowflake
- **DevOps**: Atlassian (Jira, Confluence), GitHub, GitLab
- **Security**: CrowdStrike, Palo Alto Networks

**A2A Status**:
- âœ… Google ADK: Native A2A support
- ğŸŸ¡ AWS: A2A via Gateway service (roadmap)
- ğŸŸ¡ Salesforce: A2A integration (roadmap)
- âš ï¸ Microsoft: Custom connector needed (no native A2A yet)

**The bet**: A2A becomes the "SMTP for agents" â€” a standard protocol for agent communication across platforms.

---

## Unified Core Architecture: The Seven Layers

All agentic platforms provide these seven layers:

```text
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘           UNIFIED AGENTIC PLATFORM ARCHITECTURE                  â•‘
â•‘                  "The Cloud OS for Agents"                       â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                  â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  LAYER 7: AGENT APPLICATIONS                               â”‚ â•‘
â•‘  â”‚  Your custom agents, business logic, reasoning strategies  â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ â•‘
â•‘  â”‚  â”‚Customer  â”‚ â”‚  Sales   â”‚ â”‚   Data   â”‚ â”‚   Code   â”‚      â”‚ â•‘
â•‘  â”‚  â”‚ Service  â”‚ â”‚Assistant â”‚ â”‚ Analyst  â”‚ â”‚  Helper  â”‚      â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                           â”‚                                     â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  LAYER 6: AGENT RUNTIME ENGINE                             â”‚ â•‘
â•‘  â”‚  Execution, orchestration, lifecycle management            â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚ â•‘
â•‘  â”‚  â”‚ Reasoning Loop  â”‚  â”‚ Multi-Agent     â”‚  â”‚ Workflow   â”‚ â”‚ â•‘
â•‘  â”‚  â”‚ (ReAct, CoT)    â”‚  â”‚ Orchestration   â”‚  â”‚ Execution  â”‚ â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                           â”‚                                     â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  LAYER 5: TOOL GATEWAY                                     â”‚ â•‘
â•‘  â”‚  Unified interface to external tools and services          â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â•‘
â•‘  â”‚  â”‚ MCP Client  â”‚  â”‚ API Proxies â”‚  â”‚ SDK Wrappersâ”‚        â”‚ â•‘
â•‘  â”‚  â”‚ (standard)  â”‚  â”‚ (REST, etc.)â”‚  â”‚ (custom)    â”‚        â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â”‚ â•‘
â•‘  â”‚         â”‚                â”‚                â”‚                â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”         â”‚ â•‘
â•‘  â”‚  â”‚ Auth, Rate Limiting, Retries, Caching         â”‚         â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜         â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                           â”‚                                     â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  LAYER 4: MEMORY SERVICE                                   â”‚ â•‘
â•‘  â”‚  Persistent state, context, and knowledge                  â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â•‘
â•‘  â”‚  â”‚ Short-Term  â”‚  â”‚ Long-Term   â”‚  â”‚ Semantic    â”‚        â”‚ â•‘
â•‘  â”‚  â”‚ Memory      â”‚  â”‚ Memory      â”‚  â”‚ Memory      â”‚        â”‚ â•‘
â•‘  â”‚  â”‚ (session)   â”‚  â”‚ (history)   â”‚  â”‚ (vector DB) â”‚        â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                           â”‚                                     â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  LAYER 3: IDENTITY & ACCESS MANAGEMENT                     â”‚ â•‘
â•‘  â”‚  Agent identity, permissions, and security                 â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â•‘
â•‘  â”‚  â”‚ Agent ID    â”‚  â”‚ Permissions â”‚  â”‚ Audit Logs  â”‚        â”‚ â•‘
â•‘  â”‚  â”‚ (who am I?) â”‚  â”‚ (what can   â”‚  â”‚ (what did   â”‚        â”‚ â•‘
â•‘  â”‚  â”‚             â”‚  â”‚  I do?)     â”‚  â”‚  I do?)     â”‚        â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                           â”‚                                     â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  LAYER 2: OBSERVABILITY                                    â”‚ â•‘
â•‘  â”‚  Monitoring, debugging, and cost tracking                  â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â•‘
â•‘  â”‚  â”‚ Reasoning   â”‚  â”‚ Distributed â”‚  â”‚ Cost        â”‚        â”‚ â•‘
â•‘  â”‚  â”‚ Traces      â”‚  â”‚ Tracing     â”‚  â”‚ Tracking    â”‚        â”‚ â•‘
â•‘  â”‚  â”‚ (why?)      â”‚  â”‚ (how?)      â”‚  â”‚ (how much?) â”‚        â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                           â”‚                                     â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â•‘
â•‘  â”‚  LAYER 1: AGENT COMMUNICATION (A2A)                        â”‚ â•‘
â•‘  â”‚  Agent-to-agent discovery, messaging, and coordination     â”‚ â•‘
â•‘  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚ â•‘
â•‘  â”‚  â”‚ Discovery   â”‚  â”‚ Messaging   â”‚  â”‚ Context     â”‚        â”‚ â•‘
â•‘  â”‚  â”‚ (who?)      â”‚  â”‚ (messages)  â”‚  â”‚ Transfer    â”‚        â”‚ â•‘
â•‘  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚ â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â•‘
â•‘                                                                 â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

### Layer Breakdown

| Layer | Purpose | Example Components | Platform Examples |
|-------|---------|-------------------|------------------|
| **7. Applications** | Your agent logic | Custom agents, business rules | Your code |
| **6. Runtime Engine** | Execute agents | Reasoning loop, orchestration | Google Agent Engine, AWS Lambda |
| **5. Tool Gateway** | Connect to services | MCP client, API proxies | AWS Gateway, Google ADK tools |
| **4. Memory Service** | Store context | Vector DB, session state | Vertex AI Vector, Bedrock Memory |
| **3. Identity/Auth** | Secure access | Agent ID, permissions, audit | GCP IAM, AWS IAM, Entra ID |
| **2. Observability** | Monitor & debug | Traces, logs, cost tracking | Cloud Logging, CloudWatch |
| **1. A2A Communication** | Agent coordination | Discovery, messaging | A2A Protocol, custom |

**Key Insight**: Every platform provides these layers. The **difference** is:

- **How opinionated** (Salesforce: very; Google: flexible)
- **How integrated** (AWS: tight AWS coupling; Google: cross-cloud)
- **How mature** (Microsoft: years of production; Google: months)

---

## Detailed View: How a Request Flows

**Scenario**: User asks Customer Service agent: "What's the status of my order?"

```text
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                 REQUEST FLOW THROUGH PLATFORM                    â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘                                                                  â•‘
â•‘  1. USER REQUEST                                                 â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ User: "What's the status of my order #12345?"           â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                           â”‚                                      â•‘
â•‘                           â–¼                                      â•‘
â•‘  2. AGENT APPLICATION (Layer 7)                                  â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ Customer Service Agent receives request                  â”‚   â•‘
â•‘  â”‚ â”€ Parses intent: "order status lookup"                   â”‚   â•‘
â•‘  â”‚ â”€ Identifies need: query order system                    â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                           â”‚                                      â•‘
â•‘                           â–¼                                      â•‘
â•‘  3. RUNTIME ENGINE (Layer 6)                                     â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ Reasoning Loop (ReAct):                                   â”‚   â•‘
â•‘  â”‚ â”€ Thought: "I need order data for #12345"                â”‚   â•‘
â•‘  â”‚ â”€ Action: Call tool "query_order_system"                 â”‚   â•‘
â•‘  â”‚ â”€ Observation: (wait for tool result)                    â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                           â”‚                                      â•‘
â•‘                           â–¼                                      â•‘
â•‘  4. IDENTITY CHECK (Layer 3)                                     â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ IAM Service:                                              â”‚   â•‘
â•‘  â”‚ â”€ Who is this agent? â†’ customer_service_agent            â”‚   â•‘
â•‘  â”‚ â”€ Can it read orders? â†’ Check permissions                â”‚   â•‘
â•‘  â”‚ â”€ Result: âœ… Allowed                                      â”‚   â•‘
â•‘  â”‚ â”€ Audit log: [2025-10-26 14:23:15] agent accessed ordersâ”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                           â”‚                                      â•‘
â•‘                           â–¼                                      â•‘
â•‘  5. TOOL GATEWAY (Layer 5)                                       â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ MCP Client:                                               â”‚   â•‘
â•‘  â”‚ â”€ Discover: "query_order_system" â†’ MCP Server: Orders    â”‚   â•‘
â•‘  â”‚ â”€ Call: mcp.call("query_order_system", {"order_id": ...})â”‚   â•‘
â•‘  â”‚ â”€ Handles: OAuth, rate limits, retries, caching          â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                           â”‚                                      â•‘
â•‘                           â”‚ HTTP/JSON-RPC to Order System        â•‘
â•‘                           â”‚                                      â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ Order System API:                                         â”‚   â•‘
â•‘  â”‚ â”€ Query: SELECT * FROM orders WHERE id = 12345           â”‚   â•‘
â•‘  â”‚ â”€ Result: {status: "shipped", tracking: "UPS123"}        â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                           â”‚                                      â•‘
â•‘                           â–¼                                      â•‘
â•‘  6. MEMORY SERVICE (Layer 4)                                     â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ Store conversation context:                               â”‚   â•‘
â•‘  â”‚ â”€ User asked about order #12345                           â”‚   â•‘
â•‘  â”‚ â”€ System returned: "shipped, UPS123"                      â”‚   â•‘
â•‘  â”‚ â”€ Next query can reference this (e.g., "Where is it?")   â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                           â”‚                                      â•‘
â•‘                           â–¼                                      â•‘
â•‘  7. RUNTIME ENGINE (Layer 6) - Continued                         â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ Reasoning Loop:                                           â”‚   â•‘
â•‘  â”‚ â”€ Observation: Order #12345 is shipped, tracking UPS123  â”‚   â•‘
â•‘  â”‚ â”€ Thought: "I have the answer"                            â”‚   â•‘
â•‘  â”‚ â”€ Action: Respond to user                                â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                           â”‚                                      â•‘
â•‘                           â–¼                                      â•‘
â•‘  8. OBSERVABILITY (Layer 2)                                      â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ Logs captured:                                            â”‚   â•‘
â•‘  â”‚ â”€ Reasoning trace: intent â†’ tool call â†’ response         â”‚   â•‘
â•‘  â”‚ â”€ Distributed trace: latency breakdown                   â”‚   â•‘
â•‘  â”‚ â”€ Cost: 2000 LLM tokens ($0.02) + API calls ($0.001)     â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                           â”‚                                      â•‘
â•‘                           â–¼                                      â•‘
â•‘  9. AGENT RESPONSE                                               â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ Agent: "Your order #12345 has been shipped!              â”‚   â•‘
â•‘  â”‚         Tracking: UPS123                                  â”‚   â•‘
â•‘  â”‚         Estimated delivery: Tomorrow"                     â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                           â”‚                                      â•‘
â•‘                           â–¼                                      â•‘
â•‘  10. USER RECEIVES RESPONSE                                      â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â•‘
â•‘  â”‚ User sees answer in chat/UI                               â”‚   â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â•‘
â•‘                                                                  â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

TOTAL TIME: ~1-2 seconds
TOTAL COST: $0.021 (LLM + API calls)
VISIBILITY: Full trace, every step logged
```

### What the Platform Handled

**Without platform** (DIY):
- Your team builds: Authentication, rate limiting, retries, caching, logging, tracing, cost tracking
- Your code: ~1000+ lines of infrastructure glue

**With platform**:
- Platform handles: All infrastructure layers (1-6, except your agent logic)
- Your code: ~50 lines (agent logic only)

**The 20x productivity multiplier.**

---

## Summary: Protocols & Architecture

**MCP (Model Context Protocol)**:
- âœ… Standard tool integration (like USB-C)
- âœ… 100+ community servers
- âœ… Supported by AWS, Google, Salesforce, Claude

**A2A (Agent-to-Agent Protocol)**:
- âœ… Standard agent communication
- âœ… 50+ Google partners
- âœ… Discovery, context transfer, security built-in

**Unified Architecture**:
- 7 layers every platform provides
- Layer 7: Your agent logic
- Layers 1-6: Platform handles infrastructure

**Key Insight**: Platforms abstract complexity, just like operating systems did 60 years ago.

---

## Next: Real Implementation Guide

We've seen the architecture. Now let's **build** something.

In [Part 5](./05-implementation.md), we'll cover:
- Google ADK code example (verified, real APIs)
- AWS Bedrock code example (verified, real APIs)
- Microsoft Copilot Studio patterns
- Salesforce Agentforce examples
- Quick Wins Timeline (Week 1, 4, 12)
- Real metrics from deployments

Time to get hands-on.

[Continue to Part 5 â†’](./05-implementation.md)

---

[â† Previous: Platforms Compared](./03-platforms-compared.md) | [Back to Index](./README.md) | [Next: Implementation Guide â†’](./05-implementation.md)
